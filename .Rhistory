install.packages("tidyverse")
install.packages("fda")
library(fda)
library(fda)
2+3
log(12)
sqrt(121)
x<-15
x
y<-3
x+y
0:5
install.packages("data.table")
install.packages("readr")
install.packages("RMySQL")
install.packages("sqldf")
install.packages("jsonlite")
install.packages("ggplot2")
install.packages("dplyr")
install.packages("plyr")
install.packages("tidyr")
install.packages("lubridate")
install.packages("stringr")
install.packages("randomForest")
install.packages("rpart")
install.packages("gbm")
install.packages("caret")
install.packages("swirl")
library(swirl)
#
# EDA + Introduction to R
# Author: L?dia Montero
#
citation()
library(car)
data(Davis)
ls()
attributes(Davis)
# Numeric Univariant Description
summary(Davis)
# Rows and columns of data.frame Davis
dim(Davis)
par(mfrow=c(2,2))
hist(Davis$weight)
hist(Davis$weight,10)
hist(Davis$weight,10,col="blue")
hist(Davis$weight,10,col=rainbow(10))
hist(Davis$weight,freq=F)  # Proportions
?hist
# Dotplot
par(mfrow=c(2,1))
stripchart(Davis$weight,method="stack")
stripchart(Davis$weight,method="stack",xlab="weight",pch=19,col=3,main="Dotplot Weight in Davis dataset")
# Boxplot
library(car)
par(mfrow=c(2,3))
boxplot(Davis$weight)
boxplot(Davis$weight,col="blue",horizontal = TRUE)
boxplot(Davis$weight,col="blue",horizontal = TRUE, pch=19,labels=Davis$weight)
Boxplot(Davis$weight)
Boxplot(Davis$weight,col="blue",main= "Weight in Davis dataset - row name Id")
Boxplot(Davis$weight,col="blue",main=" Boxplot Weight - Weight Label for Outliers",labels=Davis$weight)
?boxplot
# Description of factors
table(Davis$sex)
margin.table(table(Davis$sex))
prop.table(table(Davis$sex))
par(mfrow=c(2,2))
barplot(table(Davis$sex))
barplot(table(Davis$sex),col=rainbow(2))
pie(table(Davis$sex))
pie(table(Davis$sex),col=rainbow(2))
?table
?barplot
# Browsing data
View(Davis)
head(Davis, n = 20) # n = 20 means  that the first 20 lines are printed in the R console
attach(Davis)
summary(weight)
detach(Davis)
summary(weight) # Do not work
library(car)
data(Davis)
names(Davis)
head(Davis)
with(Davis,tapply(height,sex,summary))
summary(Davis$height)
with(Davis,Boxplot(height~sex,pch=19,col=rainbow(2),main="Height vs Sex"))
---
title: "Introduction to R, RStudio"
---
title: "Introduction to R, RStudio"
---
title: "Introduction to R, RStudio"
---
title: "Introduction to R, RStudio"
citation()
library(car)
library(missMDA)
install.packages(missMDA)
library(mice)
library(missMDA)
install.packages(missMDA)
install.packages("missMDA")
library(missMDA)
library(mice)
Prestige
df<-Prestige
summary(df)
df$f.prof <- 0
df$census <-NULL
df$f.prof <- 0
df$f.prof[df$type=="prof"] <- 1
df$f.prof <- factor(df$f.prof, labels = c("no", "yes"))
summary(df)
df$f.prof <- 0
df$f.prof[df$type=="prof"] <- 1
df$f.prof <- factor(df$f.prof, labels = c("No", "Yes"))
summary(df)
# women 0 is missing data
ll <-which(df$women==0)
df$women[ll] <-NA
summary(df)
res.impPCA <- imputePCA(df[,1:4])
str(res.imPCA)
str(res.impPCA)
summary(res.impPCA$completeObs)
#We can check deciles to be sure new data is consistent and not weird
quantile(df$women, prob=seq(0,1,0.1), na.rm=T)
quantile(res.impPCA$completeObs[,3], prob=seq(0,1,0.1)) #After imputation
quantile(res.impPCA$completeObs$women, prob=seq(0,1,0.1)) #After imputation
[,3]
quantile(res.impPCA$completeObs$women, prob=seq(0,1,0.1)) #After imputation
quantile(res.impPCA$completeObs[,3], prob=seq(0,1,0.1)) #After imputation
res.mice <- mice(df)
summary(complete(res.mice))
#to impute factor missing data using missMDA imputeMCA() we do this
df$type <- prestige$type #not necessary, this is to reset data to original after what we did before
names(df)
res.impMCA <- imputeMCA(df[,5:6])
summary(df[,5:6])
summary(res.impMCA$completeObs)
#first possibility
hist(df$prestige, 12)
#2nd possibility
summary(df$prestige)
#first possibility
hist(df$prestige, 12, freq=F)
#first possibility
hist(df$prestige, 12, freq=F, col="cyan")
curve(dnorm(x,mm,ss), add=T)
mm = mean(df$prestige) #to make a normal curve overlapping we need this before
ss = sd(df$prestige)
curve(dnorm(x,mm,ss), add=T)
#3rd possibility (statistical tests)
shapiro.test(df$prestige)#H0:prestige is normally distributed
ks.test(df$prestige)
ks.test(df$prestige, "pnorm", mean=mm, sd=ss)
?t.test
t.test(df$prestige)
#non parametric test for mean: wilcox.test
wilcox.test(df$prestige)
#non parametric test for mean: wilcox.test
wilcox.test(df$prestige, conf.int=T)
#Normal hypothesis is important
library(EnvStats)
#Normal hypothesis is important
install.packages("EnvStats")
library(EnvStats)
varTest(df$prestige)
Prestige
library(AER)
install.packages(AER)
install.packages("AER")
rm(list=ls())  #remove everything from enviroment
library(car)
library(AER)
library(mice)
library(FactoMineR)
Prestige
?oneway.test
library(crayon)
library(car)
library(FactoMineR)
library(chemometrics)
library(corrplot)
library(RColorBrewer)
library(PerformanceAnalytics)
library(mice)
library(dplyr)
getwd()
knitr::opts_chunk$set(echo = TRUE)
library(mclust) # For Gaussian Mixture Models (GMM)
library(ks)     # For Kernel Density Estimation (KDE) with Hlscv bandwidth selection
library(vegan)  # For ISOMAP
library(Rtsne)  # For t-SNE
library(stats)  # For princomp (PCA)
library(knitr)  # For kable tables
library(dplyr)  # For data manipulation convenience
# Load the dataset
load("ExamOctober2023.Rdata")
# Extract the relevant columns
le_birth <- LE[, 1]
lg_dif_le_15 <- lgDifLE[, 15] # lgDifLE columns are 1-100 for ages 1-100
# Center and scale the data
x_scaled <- scale(le_birth)
y_scaled <- scale(lg_dif_le_15)
# Combine into a matrix X
X <- cbind(x = x_scaled, y = y_scaled)
n <- nrow(X) # Number of countries
# Define the sequence of 'a' values to test
a_values <- seq(0.15, 0.3, by = 0.025)
# Initialize vector to store log-likelihoods
loo_logliks_a <- numeric(length(a_values))
knitr::opts_chunk$set(echo = TRUE)
?Mclust
library(mclust)
?Mclust
setwd("C:/Users/Daniel/Desktop/ASM/Project 2")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
# Load necessary libraries
library(tseries)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
# Load necessary libraries
library(tseries)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
# Load necessary libraries
library(tseries)
library(forecast)
# Read the data
data <- read.table("ConsumElec.dat", header = FALSE)
# Create a time series object
serie <- ts(data$V1, start = c(1990, 1), frequency = 12)
# Plot the raw time series
plot(serie, main = "Raw Time Series (ConsumElec.dat)", ylab = "Sales (Units or Index)", xlab = "Time (Years)", col = 4, lwd = 2)
abline(h = mean(serie), col = 2, lty = 2)
# Read the data
serie=window(ts(read.table("ConsumElec.dat"),start=1990,freq=12))
# Plot the raw time series
plot(serie, main="Gross internal consumption of electrical energy in Spain", ylab="GwH")
abline(v=1985:2020,lty=3,col=4)
lnserie <- log(serie)
plot(lnserie, main = "Log-Transformed Time Series", ylab = "ln(Sales)", xlab = "Time (Years)", col = 4, lwd = 2)
abline(h = mean(lnserie), col = 2, lty = 2)
d12lnserie <- diff(lnserie, lag = 12)
plot(d12lnserie, main = "Seasonally Differenced Log-Series", ylab = "$\\Delta_{12} \\ln (X_t)$", xlab = "Time (Years)", col = 4, lwd = 2)
abline(h = mean(d12lnserie), col = 2, lty = 2)
lnserie <- log(serie)
plot(lnserie)
abline(h = mean(lnserie), col = 2, lty = 2)
d12lnserie <- diff(lnserie, lag = 12)
plot(d12lnserie)
abline(h = mean(d12lnserie), col = 2, lty = 2)
d1d12lnserie <- diff(d12lnserie, lag = 1)
plot(d1d12lnserie)
abline(h = 0, col = 2, lty = 2)
# Check for over-differencing (variance comparison)
var_raw <- var(lnserie)
var_d12 <- var(d12lnserie)
var_d1d12 <- var(d1d12lnserie)
cat(sprintf("Variance of ln(X_t): %f\n", var_raw))
cat(sprintf("Variance of D=1 Series: %f\n", var_d12))
cat(sprintf("Variance of d=1, D=1 Series: %f\n", var_d1d12))
d1d1d12lnserie <- diff(d1d12lnserie, lag = 1)
plot(d1d1d12lnserie)
abline(h = 0, col = 2, lty = 2)
# Check for over-differencing (variance comparison)
var_raw <- var(lnserie)
var_d12 <- var(d12lnserie)
var_d1d12 <- var(d1d12lnserie)
var_d1d1d12 <- var(d1d1d12lnserie)
cat(sprintf("Variance of ln(X_t): %f\n", var_raw))
cat(sprintf("Variance of D=1 Series: %f\n", var_d12))
cat(sprintf("Variance of d=1, D=1 Series: %f\n", var_d1d12))
cat(sprintf("Variance of d=2, D=1 Series: %f\n", var_d1d12))
d1d1d12lnserie <- diff(d1d12lnserie, lag = 1)
plot(d1d1d12lnserie)
abline(h = 0, col = 2, lty = 2)
# Check for over-differencing (variance comparison)
var_raw <- var(lnserie)
var_d12 <- var(d12lnserie)
var_d1d12 <- var(d1d12lnserie)
var_d1d1d12 <- var(d1d1d12lnserie)
cat(sprintf("Variance of ln(X_t): %f\n", var_raw))
cat(sprintf("Variance of D=1 Series: %f\n", var_d12))
cat(sprintf("Variance of d=1, D=1 Series: %f\n", var_d1d12))
cat(sprintf("Variance of d=2, D=1 Series: %f\n", var_d1d1d12))
par(mfrow = c(1, 2))
acf(d1d12lnserie, lag.max = 60, main = "ACF of W_t", lwd = 2)
pacf(d1d12lnserie, lag.max = 60, main = "PACF of W_t", lwd = 2)
par(mfrow = c(1, 1))
par(mfrow = c(1, 2))
acf(d12lnserie, lag.max = 60, main = "ACF of W_t", lwd = 2)
pacf(d12lnserie, lag.max = 60, main = "PACF of W_t", lwd = 2)
par(mfrow = c(1, 1))
serie=window(ts(read.table("ConsumElec.dat"),start=1990,freq=12))
plot(serie, main="Gross internal consumption of electrical energy in Spain", ylab="GwH")
abline(v=1985:2020,lty=3,col=4)
png("plots/raw_series.png", width = 900, height = 600)
serie=window(ts(read.table("ConsumElec.dat"),start=1990,freq=12))
plot(serie, main="Gross internal consumption of electrical energy in Spain", ylab="GwH")
abline(v=1985:2020,lty=3,col=4)
ggplot2::ggsave("plots/raw_series.png")
lnserie <- log(serie)
plot(lnserie)
abline(h = mean(lnserie), col = 2, lty = 2)
ggplot2::ggsave("plots/log_transform_variance.png")
d12lnserie <- diff(lnserie, lag = 12)
plot(d12lnserie)
abline(h = mean(d12lnserie), col = 2, lty = 2)
ggplot2::ggsave("plots/seasonal_differencing.png")
d1d12lnserie <- diff(d12lnserie, lag = 1)
plot(d1d12lnserie)
abline(h = 0, col = 2, lty = 2)
ggplot2::ggsave("plots/regular_diff.png")
d1d1d12lnserie <- diff(d1d12lnserie, lag = 1)
plot(d1d1d12lnserie)
abline(h = 0, col = 2, lty = 2)
ggplot2::ggsave("plots/regular_diff_twice.png")
# Check for over-differencing (variance comparison)
var_raw <- var(lnserie)
var_d12 <- var(d12lnserie)
var_d1d12 <- var(d1d12lnserie)
var_d1d1d12 <- var(d1d1d12lnserie)
cat(sprintf("Variance of ln(X_t): %f\n", var_raw))
cat(sprintf("Variance of D=1 Series: %f\n", var_d12))
cat(sprintf("Variance of d=1, D=1 Series: %f\n", var_d1d12))
cat(sprintf("Variance of d=2, D=1 Series: %f\n", var_d1d1d12))
par(mfrow = c(1, 2))
acf(d1d12lnserie, lag.max = 60, main = "ACF of W_t", lwd = 2)
pacf(d1d12lnserie, lag.max = 60, main = "PACF of W_t", lwd = 2)
par(mfrow = c(1, 1))
ggplot2::ggsave("plots/acf_pacf_d1D1.png")
par(mfrow = c(1, 2))
acf(d12lnserie, lag.max = 60, main = "ACF of W_t", lwd = 2)
pacf(d12lnserie, lag.max = 60, main = "PACF of W_t", lwd = 2)
par(mfrow = c(1, 1))
ggplot2::ggsave("plots/acf_pacf_d0D1.png")
serie=window(ts(read.table("ConsumElec.dat"),start=1990,freq=12))
plot(serie, main="Gross internal consumption of electrical energy in Spain", ylab="GwH")
abline(v=1985:2020,lty=3,col=4)
dev.copy(png, filename = "plots/raw_series.png", width = 900, height = 600)
dev.off()
lnserie <- log(serie)
plot(lnserie)
abline(h = mean(lnserie), col = 2, lty = 2)
dev.copy(png, filename = "plots/log_transform_variance.png", width = 900, height = 600)
dev.off()
d12lnserie <- diff(lnserie, lag = 12)
plot(d12lnserie)
abline(h = mean(d12lnserie), col = 2, lty = 2)
dev.copy(png, filename = "plots/seasonal_differencing.png", width = 900, height = 600)
dev.off()
d1d12lnserie <- diff(d12lnserie, lag = 1)
plot(d1d12lnserie)
abline(h = 0, col = 2, lty = 2)
dev.copy(png, filename = "plots/regular_differencing.png", width = 900, height = 600)
dev.off()
d1d1d12lnserie <- diff(d1d12lnserie, lag = 1)
plot(d1d1d12lnserie)
abline(h = 0, col = 2, lty = 2)
dev.copy(png, filename = "plots/regular_differencing_2.png", width = 900, height = 600)
dev.off()
# Check for over-differencing (variance comparison)
var_raw <- var(lnserie)
var_d12 <- var(d12lnserie)
var_d1d12 <- var(d1d12lnserie)
var_d1d1d12 <- var(d1d1d12lnserie)
cat(sprintf("Variance of ln(X_t): %f\n", var_raw))
cat(sprintf("Variance of D=1 Series: %f\n", var_d12))
cat(sprintf("Variance of d=1, D=1 Series: %f\n", var_d1d12))
cat(sprintf("Variance of d=2, D=1 Series: %f\n", var_d1d1d12))
par(mfrow = c(1, 2))
acf(d1d12lnserie, lag.max = 60, main = "ACF of W_t", lwd = 2)
pacf(d1d12lnserie, lag.max = 60, main = "PACF of W_t", lwd = 2)
par(mfrow = c(1, 1))
dev.copy(png, filename = "plots/acf_pacf_stationary_d1D1.png", width = 1200, height = 600)
dev.off()
par(mfrow = c(1, 2))
acf(d12lnserie, lag.max = 60, main = "ACF of W_t", lwd = 2)
pacf(d12lnserie, lag.max = 60, main = "PACF of W_t", lwd = 2)
par(mfrow = c(1, 1))
dev.copy(png, filename = "plots/acf_pacf_stationary_d0D1.png", width = 1200, height = 600)
dev.off()
